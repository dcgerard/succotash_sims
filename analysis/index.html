<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Home</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}


/* offset scroll position for anchor links (for fixed navbar)  */
.section h2 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h3 {
  padding-top: 55px;
  margin-top: -55px;
}



/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="libs/highlight/textmate.css"
      type="text/css" />
<script src="libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">succotash_sims</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="LICENSE">License</a></li>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Home</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#known-grid-confounders-and-variances.">Known: Grid, Confounders, and Variances.</a></li>
<li><a href="#known-grid-and-confounders.">Known: Grid and Confounders.</a></li>
<li><a href="#all-null-sims.-grid-confounders-and-variance-unknown.">All Null Sims. Grid, Confounders, and Variance <em>unknown</em>.</a></li>
<li><a href="#nonnull-sims.-grid-confounders-and-variance-unknown.">Nonnull Sims. Grid, Confounders, and Variance <em>unknown</em>.</a></li>
<li><a href="#other-implementation-checks.">Other Implementation Checks.</a></li>
<li><a href="#gtex-analysis">GTEX Analysis</a></li>
<li><a href="#individual-datasets">Individual Datasets</a></li>
<li><a href="#ruvb">RUVB</a></li>
<li><a href="#shiny-app">Shiny App</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p><strong>Last updated:</strong> 2016-09-19</p>
<p><strong>Code version:</strong> db340876f21fef701d6caedf2ac96ff1af1de884</p>
<div id="known-grid-confounders-and-variances." class="section level2">
<h2>Known: Grid, Confounders, and Variances.</h2>
<ul>
<li><a href="alpha_sig_known.pdf">Grid size of 3 with variances close together, <span class="math inline">\(\pi_0\)</span> overestimated.</a></li>
<li><a href="alpha_sig_tau_known.pdf">Grid size of 3 with one variance very far apart, <span class="math inline">\(\pi_0\)</span> accurately estimated.</a></li>
</ul>
</div>
<div id="known-grid-and-confounders." class="section level2">
<h2>Known: Grid and Confounders.</h2>
<ul>
<li><a href="alpha_tau_known_1df_writeup.pdf">Variances drawn from <span class="math inline">\(\chi^2_1\)</span>.</a></li>
<li><a href="alpha_tau_known_writeup.pdf">Variances drawn from <span class="math inline">\(\chi^2_5\)</span>.</a></li>
</ul>
</div>
<div id="all-null-sims.-grid-confounders-and-variance-unknown." class="section level2">
<h2>All Null Sims. Grid, Confounders, and Variance <em>unknown</em>.</h2>
<ul>
<li><a href="count_theo_sims.pdf">Idealized data from SUCCOTASH model. SUCCOTASH underestimates lfdr but does better in terms of squared error loss.</a></li>
<li><a href="count_theo_sims_cpm.pdf">Same as above but using counts-per-million as output.</a></li>
<li><a href="suc_v_rest_real_writeup.pdf">Lung data, covariates randomized, n = 200, SUCCOTASH does best in terms of SSE and OK in terms of lfdr.</a></li>
<li><a href="suc_v_rest_real_writeu_20v20.pdf">Same as previous but with n = 40. Still best in terms of SSE but lfdr performance is horrible.</a></li>
<li><a href="null_behavior.pdf">RUV4’s t-statistics means and standard deviations when and when not estimating a variance inflation parameter.</a></li>
<li><a href="null_behaviort.pdf">Same as above but using t-likelihood when estimating the variance inflation parameter.</a></li>
</ul>
</div>
<div id="nonnull-sims.-grid-confounders-and-variance-unknown." class="section level2">
<h2>Nonnull Sims. Grid, Confounders, and Variance <em>unknown</em>.</h2>
<ul>
<li><a href="count_theo_nonnull_cpm.pdf">Idealized data from SUCCOTASH model. SUCCOTASH underestimates <span class="math inline">\(\pi_0\)</span> but does well in terms of squared error loss.</a></li>
<li><a href="varyNsampNullpiLog2sd.pdf">31 competitors, varying n, <span class="math inline">\(\pi_0\)</span>, and log2fold sd. SUCCOTASH does well for AUC and worst for estimating <span class="math inline">\(\pi_0\)</span>.</a></li>
<li><a href="varyNsampNullpiLog2sd_smallN.pdf">Same as previous but with smaller <span class="math inline">\(n \in \{3,5\}\)</span>. SUCCOTASH performs worst in terms of <span class="math inline">\(\pi_0\)</span>.</a></li>
<li><a href="varyNsampNullpiLog2sd_cateonly.pdf">(*)Explore different options for CATE. When <span class="math inline">\(n = 20\)</span>, CATE does very well estimating <span class="math inline">\(\pi_0\)</span>.</a></li>
<li><a href="varyNsampNullpiLog2sd_cateonly_10000.pdf">Same as previous but with larger number of genes (<span class="math inline">\(p = 10,000\)</span>). <span class="math inline">\(n = 20\)</span> is still pretty good.</a></li>
<li><a href="varyNsampNullpiLog2sd_cateVsMouthwash.pdf">Include SUCCOTASH (MOUTHWASH) into the CATE comparisons with <span class="math inline">\(p = 1000\)</span>. Competitive in terms of AUC but horrible in terms of <span class="math inline">\(\pi_0\)</span>.</a></li>
<li><a href="calibrate_lambda.pdf">Same as previous but include different regularization parameters in SUCCOTASH. Even <em>very</em> large values of <span class="math inline">\(\lambda\)</span> aren’t enough.</a></li>
<li><a href="varyNsampNullpiLog2sd_cateVsFlashMouthwash.pdf">FLASH + SUCCOTASH. Good at estimating <span class="math inline">\(\pi_0\)</span>. Worse AUC than when using PCA.</a></li>
<li><a href="varyNsampNullpiLog2sd_cateVsMouthwashManyFA.pdf">Homoscedastic variance factor analyses are better calibrated than heteroscedastic models</a></li>
<li><a href="varyNsampNullpiLog2sd_cateVsMouthwashManyFA_shrinkPCA.pdf">Empirically Bayesian shrinkage of the column-wise mean squared errors works better than using the raw column-wise mean squared errors, but worse than assuming homoscedasticity.</a></li>
<li><a href="unif_mix_compare.pdf">Initial sims using uniform mixtures. Variance model more important than mixing distribution. Homoscedasticity still works best.</a></li>
<li><a href="big_sims_mouth_largen_writeup.html">SUCCOTASH vs ASH with homoscedastic and heteroscedastic assumptions and n = 10,000. Homoscedastic models are better calibrated but have worse AUC. SUCCOTASH generally has higher AUC</a></li>
<li><a href="big_sims_mouth_ashVsucc_writeup.html">Same as above but also including methods using limma-shrunk column-wise mean square as variance estimates.</a></li>
<li><a href="cate_redo.pdf">Correction of (*) where I do not inflate the variance. CATE performs much poorer in terms of estimating <span class="math inline">\(\pi_0\)</span></a></li>
<li><a href="inflate_var_sims.pdf">Inflating variance results in improved estimates of <span class="math inline">\(\pi_0\)</span> and improved MSE</a></li>
<li><a href="scale_var_sims.pdf">Estimating the scale of the variance works pretty well. Best at <span class="math inline">\(\pi_0 = 0.5\)</span> and competitively at <span class="math inline">\(\pi_0 = 0.9\)</span> and <span class="math inline">\(1\)</span></a></li>
<li><a href="scale_var_sims_fa.pdf">No big improvements when use different factor analysis in scaled-variance SUCCOTASH</a></li>
<li><a href="sva_ash_varinflate.pdf">SVA + OLS + ASH while estimating variance inflation parameter does not work well in terms of estimating the null proportion.</a> Also looked at using a penalty on the variance inflation parameter in SUCCOTASH, but only provided small improvement.s</li>
<li><a href="ashr_cate.pdf">Same as above but using CATE instead of SVA. Performance of ASH + CATE is same as ASH + SVA</a></li>
<li><a href="nopen_then_inflate.pdf">Best results I’ve seen. Used a two step procedure of estimating, then inflating, variance scaling parameter for SUCCOTASH.</a></li>
<li><a href="muscle_tissue.pdf">Plots for same scenario as above, but included t-SUCCOTASH</a></li>
<li><a href="muscle_tissue_ruv_asht.pdf">Plots for same scenario as above, but included RUV4 then ASH with t-likelihood</a></li>
<li><a href="diff_alttypes_muscle.pdf">Using same alternatives as in ASH paper, SUCCOTASH has superior performance</a></li>
<li><a href="diff_alttypes_muscle_plus_ASH.pdf">Same as above but including OLS + ASH. ASH does not perform well.</a></li>
<li><a href="diff_alttypes_muscle_plus_ASH_RUV.pdf">Same as above but use RUV + estimate scale using controls + ASH instead of ASH.</a> RUV + ASH does great with variance inflation. Call this RUVASH.</li>
<li><a href="diff_alttypes_muscle_plus_ASH_RUV_limma.pdf">Same as above but also limma-shrunk the variances prior to estimating scale and running ASH</a></li>
<li><a href="diff_alttypes_muscle_bcv.pdf">Similar to above but use bicrossvalidation to choose the number of hidden confounders. No big change in performance.</a></li>
<li><a href="pi0hat_sims.pdf">pi0 vs pi0hat for various estimates.</a> Akin to Figure 2b in <span class="citation">Stephens (2016)</span>, but using the GTEX data plus Poisson thinning to generate signal. RUVASH and SUCCOTASH do the best.</li>
<li><a href="scale_plot.pdf">Scale estimates in RUVASH invariant to alternative type.</a> Shrinks with sample size.</li>
<li><a href="diff_alttypes_ruvasht.pdf">Using t-likelihood had very little effect on the performance of RUVASH compared to using the normal likelihood.</a></li>
<li><a href="diff_alttypes_gaussian.pdf">Simulations using data generated from assumed model.</a> Results are less clear. RUVASH still appears to perform best. Need to think about settings more carefully.</li>
<li><a href="diff_alttypes_gaussian_limmashrink.pdf">Same as above but using limma-shrunk variances in RUVASH and reduced variances of non-signal.</a> RUVASH does great in terms of AUC, wins in estimating <span class="math inline">\(\pi_0\)</span> when <span class="math inline">\(n\)</span> is large.</li>
<li><a href="diff_alttypes_muscle_mad.pdf">Same as above, but used MAD-inflated + ASH methods.</a> RUVASH still works the best. SUCCOTASH works the best among methods that don’t use control genes.</li>
<li><a href="muscle_tissue_madt.pdf">Mad inflated + ASH methods using t-likelihood for MAD inflation and ASH.</a> Same simulation settings as <a href="nopen_then_inflate.pdf">here.</a></li>
<li><a href="muscle_tissue_succ_then_ash.pdf">Using SUCCOTASH to estimate unimodal inflation using control genes works ok.</a> It is slightly anticonservative for small n. For larger n, SUCCOTASH estimates the proportion of nulls to be near 1. In this case, the confounders are estimated the exact same as in GLS, and SUCCOTASH reduces to RUVASH. Don’t know if there is any benefit to using unimodal inflation.</li>
<li><a href="muscle_tissue_largen.pdf">Simulations using n = 200.</a> MAD inflated RUV and RUVASH work equally well for large <span class="math inline">\(\pi_0\)</span>.</li>
<li><a href="muscle_tissue_alpha1.pdf">RUVASH simulations using alpha = 1</a> This is where the t-statistics are assumed to be exchangeable. The coding is the first T/F is for posthoc_inflate the second T/F is for limmashrink. <span class="math inline">\(\pi_0\)</span> is still accurately estimated, but the post-hoc inflation seems to be less necessary. AUC is almost exactly the same when limmashrink = FALSE as cate_nc, which it should be. limmashrink = TRUE increases the AUC a little bit.</li>
<li><a href="muscle_tissue_adinf.pdf">Additive inflation almost always estimated near zero.</a> Same coding as above. This is particularly true for n &gt;= 10 and for limmashrunk variances.</li>
<li><a href="different_ruvashes.pdf">Small improvement to RUVASH by using X AND Zhat to estimate standard errors of betahat.</a></li>
<li><a href="max_numsv.pdf">RUVASH using maximum number of factors allowed.</a> As long as limmashrunk variances are used, this actually works quite well.</li>
<li><a href="adjust_bias.html">Bias adjustment seems to slightly improve AUC but at the expense of slightl worse calibration.</a></li>
</ul>
</div>
<div id="other-implementation-checks." class="section level2">
<h2>Other Implementation Checks.</h2>
<ul>
<li><a href="check_with_ash.pdf">Gives same results as <code>ashr</code> when no confounders.</a></li>
<li><a href="succotash_ests.html">An example where SUCCOTASH performs poorly</a></li>
<li><a href="known_grid.html">Grid is known, SUCCOTASH performs well</a></li>
<li><a href="test_tlike.pdf">t-likelihood seems to be implemented correctly</a></li>
<li><a href="scale_check.pdf">Scaling variances seems to be coded up correctly</a></li>
<li><a href="explore_ruvmult.html">Scaling factor probably not because of augmented design matrix.</a> ASH lfdr ordering different when scaling variance, even though t-statistics remain unchanged.</li>
<li><a href="limmashrink_invariance.html">Limma is scale-equivariant</a></li>
<li><a href="muscle_succ_diff_init.pdf">SUCCOTASH gives reasonable results no matter the starting positions.</a></li>
<li><a href="muscle_succ_diff_init_onestep.pdf">Same as above but one-step SUCCOTASH rather than two-step SUCCOTASH.</a></li>
</ul>
</div>
<div id="gtex-analysis" class="section level2">
<h2>GTEX Analysis</h2>
<ul>
<li><a href="gtex_clean.html">Procedure for cleaning the GTEX data for heart.</a></li>
<li><a href="gtex_clean_muscle.html">Exact same as above but for muscle.</a></li>
<li><a href="gtex_clean_blood.html">Exact same as above but for blood.</a></li>
<li><a href="analyze_cleaned_gtex.html">RUV4 and RUVASH give very similar results for top genes in heart data.</a></li>
<li><a href="analyze_cleaned_gtex_muscle.html">Same plots as above but for muscle.</a></li>
<li><a href="analyze_cleaned_gtex_blood.html">Same plots as above but for blood.</a></li>
<li><a href="inflation_vs_nsamp.html">Seeing variance inflation estimated differently in GTEX data vs all-null setting</a></li>
<li><a href="fit_ruvasht_muscle.html">Used t-likelihood for muscle and didn’t change the result that much.</a> The differences I did observe probably only resulted because I didn’t do any posthoc inflation.</li>
</ul>
</div>
<div id="individual-datasets" class="section level2">
<h2>Individual Datasets</h2>
<ul>
<li><a href="heart_t.html">All null setting.</a> RUVASH with a t-likelihood gives really good t-statistics. Calibrated CATE also gives really good t-statistics.</li>
<li><a href="heart_t_nonnull.html">80% null setting.</a> RUVASH with a t-likelihood again does very well. Calibrated CATE does ok.</li>
<li><a href="cate_cal.html">MAD inflation always improves ASH.</a> Motivated by CATE, I used MAD inflation on the standard errors. This always improved ASH’s performance.</li>
<li><a href="change_q.html">Variance estimates seem to be OK when simulating under the assumed model.</a> But RUVASH still estimates a large variance inflation and most methods still underestimate <span class="math inline">\(\pi_0\)</span>. RUVASH seems to be over-inflating though.</li>
<li><a href="checkout_vruv2.pdf">Tried another variance inflation approach to RUV2, but it doesn’t work too well.</a> I tried accounting for inflation during the factor analysis.</li>
</ul>
</div>
<div id="ruvb" class="section level2">
<h2>RUVB</h2>
<ul>
<li><a href="compare_normalization.html">Adding 75th percentile post Poisson thinning seems best approach</a></li>
</ul>
</div>
<div id="shiny-app" class="section level2">
<h2>Shiny App</h2>
<ul>
<li>Visit <a href="https://github.com/dcgerard/succotash_sims/tree/master/analysis/mouthwash">here</a></li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-stephens2016false">
<p>Stephens, Matthew. 2016. “False Discovery Rates: A New Deal.” <em>BioRxiv</em>. Cold Spring Harbor Labs Journals, 038216.</p>
</div>
</div>
</div>


<!-- some extra javascript for older browsers -->
<script type="text/javascript" src="libs/polyfill.js"></script>

<script>

// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname
    href = href.substr(href.lastIndexOf('/') + 1)
    $('a[href="' + href + '"]').parent().addClass('active');

    // manage active menu header
    if (href.startsWith('authoring_'))
      $('a[href="' + 'authoring' + '"]').parent().addClass('active');
    else if (href.endsWith('_format.html'))
      $('a[href="' + 'formats' + '"]').parent().addClass('active');
    else if (href.startsWith('developer_'))
      $('a[href="' + 'developer' + '"]').parent().addClass('active');

});

</script>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
